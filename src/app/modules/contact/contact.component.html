<div fxFlexLayoutAlign="row" fxLayoutAlign="space-between center">
    <div class="page-title">
        <h1>{{ title }}</h1>
        <span class="breadcrumb">Home / Roles</span>
    </div>
</div>

<div class="table-content-wrapper-container mat-elevation-z8">
    <table mat-table [dataSource]="dataSource" class="app-table"
           matSort matSortActive="registrationDate" matSortDisableClear matSortDirection="desc"
    >
        <!-- Number Column -->
        <ng-container matColumnDef="number">
            <th mat-header-cell *matHeaderCellDef>#</th>
            <td mat-cell *matCellDef="let row; let i = index">{{ i + 1 }}</td>
        </ng-container>

        <!-- Name Column -->
        <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef>Name</th>
            <td mat-cell *matCellDef="let row">{{ row.name | uppercase }}</td>
        </ng-container>

        <!-- Facility Name Column -->
        <ng-container matColumnDef="facilityName">
            <th mat-header-cell *matHeaderCellDef>Facility Name</th>
            <td mat-cell *matCellDef="let row">{{ row?.organisationUnit?.name | uppercase }}</td>
        </ng-container>

        <!-- Facility Code Column -->
        <ng-container matColumnDef="facilityCode">
            <th mat-header-cell *matHeaderCellDef>Facility Code</th>
            <td mat-cell *matCellDef="let row">{{ row.facilityCode | uppercase }}</td>
        </ng-container>

        <!-- Age Column -->
        <ng-container matColumnDef="age">
            <th mat-header-cell *matHeaderCellDef>Age</th>
            <td mat-cell *matCellDef="let row">{{ row.age }}</td>
        </ng-container>

        <!-- URN Column -->
        <ng-container matColumnDef="urn">
            <th mat-header-cell *matHeaderCellDef>URN</th>
            <td mat-cell *matCellDef="let row">{{ row.urn }}</td>
        </ng-container>

        <!-- Sex Column -->
        <ng-container matColumnDef="sex">
            <th mat-header-cell *matHeaderCellDef>Sex</th>
            <td mat-cell *matCellDef="let row">{{ row.sex | uppercase }}</td>
        </ng-container>

        <!-- Fields Column -->
        <ng-container matColumnDef="fields">
            <th mat-header-cell *matHeaderCellDef>Fields</th>
            <td mat-cell *matCellDef="let row">{{ row.fields }}</td>
        </ng-container>

        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
            <th *matHeaderCellDef mat-header-cell>Action</th>
            <td *matCellDef="let row" mat-cell>
                <button mat-button matTooltip="Edit" matTooltipPosition="left" (click)="openEditDialog(row)">
                    <mat-icon>edit</mat-icon>
                </button>
            </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>

    <mat-paginator
            (page)="pageChanged($event)"
            [length]="totalRecords"
            [pageSizeOptions]="pageSizeOptions"
            aria-label="Select page of search results">
    </mat-paginator>
</div>

<app-dialog
        [fullScreen]="false"
        [open]="createEditDialogOpen"
        (onClose)="handleClose($event)"
        title="{{contactService.form.controls['uuid'].value ? 'Edit Contact': 'Create Contact'}}"
>
    <ng-template>
        <form #formDirective="ngForm"
              (ngSubmit)="submitCreateEditContactForm()"
              [formGroup]="contactService.form">
            <mat-dialog-content class="mat-typography">
                <div class="dialog-content" fxLayout="column" fxLayoutGap="20px">
                    <div fxLayout="row" fxLayoutGap="20px" fxLayout.xs="column">
                        <mat-form-field fxFlex="50" fxFlex.xs="100" appearance="outline">
                            <mat-label>Name</mat-label>
                            <input matInput
                                   formControlName="name"
                                   maxlength="255"
                                   placeholder="Enter name"
                                   required
                                   autocomplete="off">
                        </mat-form-field>

                        <mat-form-field fxFlex="50" fxFlex.xs="100" appearance="outline">
                            <mat-label>Code</mat-label>
                            <input matInput
                                   formControlName="code"
                                   maxlength="255"
                                   placeholder="Enter code"
                                   required
                                   autocomplete="off">
                        </mat-form-field>
                    </div>

                    <div fxLayout="column" fxLayoutAlign="stretch">
                        <mat-form-field appearance="outline">
                            <mat-label>Description</mat-label>
                            <textarea matInput
                                      formControlName="description"
                                      cdkTextareaAutosize
                                      #autosize="cdkTextareaAutosize"
                                      cdkAutosizeMinRows="1"
                                      cdkAutosizeMaxRows="5"
                                      placeholder="Enter description">
        </textarea>
                        </mat-form-field>
                    </div>
                </div>
            </mat-dialog-content>

            <mat-dialog-actions fxLayout="row" fxLayoutAlign="end stretch">
                <button mat-dialog-close mat-raised-button type="button">CANCEL</button>
                <button color="primary" mat-raised-button type="submit">
                    {{ contactService.form.controls['uuid'].value ? "UPDATE" : "CREATE" }}
                </button>
            </mat-dialog-actions>
        </form>
    </ng-template>
</app-dialog>
